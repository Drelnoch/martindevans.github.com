<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1008" height="1274" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Note over Mic Capture: Mic _clip.GetData
Note over Mic Capture: Buffer into _rawMicSamples
Note over Mic Capture: Read a complete frame
Mic Capture->Encoding Thread: audio frame
Note over Encoding Thread: Resample to capture rate
Note over Encoding Thread: Convert to int16
Note over Encoding Thread: Process through VAD
Note over Encoding Thread: Speex preprocessor
Note over Encoding Thread: Convert back to float32
Note over Encoding Thread: Delay buffer
Note over Encoding Thread: Encode
Note over Encoding Thread: Write into packet
Encoding Thread->Server: Send packet
Server->Client: Send packet
Note over Client: Copy packet
Note over Client: Add to transfer buffer
Client->Decoding Thread: Read from transfer buffer
Note over Decoding Thread: Add to jitter buffer
Note over Decoding Thread: Decode
Note over Decoding Thread: Apply volume ramping
Note over Decoding Thread: Convert frames to samples
Note over Decoding Thread: Apply soft clipping
Note over Decoding Thread: Split mono to all channels
Note over Decoding Thread: Playback in AudioSource]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="70.875" y="20" width="116.96875" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="80.875" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="80.875">Mic Capture</tspan></text></g><g class="actor"><rect x="70.875" y="1215" width="116.96875" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="80.875" y="1240" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="80.875">Mic Capture</tspan></text></g><line x1="129.359375" x2="129.359375" y1="59" y2="1215" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="207.84375" y="20" width="151.953125" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="217.84375" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="217.84375">Encoding Thread</tspan></text></g><g class="actor"><rect x="207.84375" y="1215" width="151.953125" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="217.84375" y="1240" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="217.84375">Encoding Thread</tspan></text></g><line x1="283.8203125" x2="283.8203125" y1="59" y2="1215" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="379.796875" y="20" width="72.984375" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="389.796875" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="389.796875">Server</tspan></text></g><g class="actor"><rect x="379.796875" y="1215" width="72.984375" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="389.796875" y="1240" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="389.796875">Server</tspan></text></g><line x1="416.2890625" x2="416.2890625" y1="59" y2="1215" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="496.6640625" y="20" width="72.78125" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="506.6640625" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="506.6640625">Client</tspan></text></g><g class="actor"><rect x="496.6640625" y="1215" width="72.78125" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="506.6640625" y="1240" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="506.6640625">Client</tspan></text></g><line x1="533.0546875" x2="533.0546875" y1="59" y2="1215" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="697.203125" y="20" width="151.953125" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="707.203125" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="707.203125">Decoding Thread</tspan></text></g><g class="actor"><rect x="697.203125" y="1215" width="151.953125" height="39" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="707.203125" y="1240" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="707.203125">Decoding Thread</tspan></text></g><line x1="773.1796875" x2="773.1796875" y1="59" y2="1215" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="note"><rect x="49.5859375" y="79" width="159.546875" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="54.5859375" y="99" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="54.5859375">Mic _clip.GetData</tspan></text></g><g class="note"><rect x="10" y="128" width="238.71875" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="15" y="148" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">Buffer into _rawMicSamples</tspan></text></g><g class="note"><rect x="31.890625" y="177" width="194.9375" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="36.890625" y="197" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="36.890625">Read a complete frame</tspan></text></g><g class="signal"><text x="158.10546875" y="236.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="158.10546875">audio frame</tspan></text><line x1="129.359375" x2="283.8203125" y1="245" y2="245" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="173.15625" y="265" width="221.328125" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="178.15625" y="285" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="178.15625">Resample to capture rate</tspan></text></g><g class="note"><rect x="208.34375" y="314" width="150.953125" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="213.34375" y="334" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="213.34375">Convert to int16</tspan></text></g><g class="note"><rect x="195.1484375" y="363" width="177.34375" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="200.1484375" y="383" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="200.1484375">Process through VAD</tspan></text></g><g class="note"><rect x="199.546875" y="412" width="168.546875" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="204.546875" y="432" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="204.546875">Speex preprocessor</tspan></text></g><g class="note"><rect x="177.5546875" y="461" width="212.53125" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="182.5546875" y="481" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="182.5546875">Convert back to float32</tspan></text></g><g class="note"><rect x="225.9375" y="510" width="115.765625" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="230.9375" y="530" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="230.9375">Delay buffer</tspan></text></g><g class="note"><rect x="252.328125" y="559" width="62.984375" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="257.328125" y="579" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="257.328125">Encode</tspan></text></g><g class="note"><rect x="204.046875" y="608" width="159.546875" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="209.046875" y="628" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="209.046875">Write into packet</tspan></text></g><g class="signal"><text x="301.671875" y="667.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="301.671875">Send packet</tspan></text><line x1="283.8203125" x2="416.2890625" y1="676" y2="676" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="426.2890625" y="706.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="426.2890625">Send packet</tspan></text><line x1="416.2890625" x2="533.0546875" y1="715" y2="715" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="479.671875" y="735" width="106.765625" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="484.671875" y="755" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="484.671875">Copy packet</tspan></text></g><g class="note"><rect x="430.6875" y="784" width="204.734375" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="436.6875" y="804" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="435.6875">Add to transfer buffer</tspan></text></g><g class="signal"><text x="543.0546875" y="843.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="543.0546875">Read from transfer buffer</tspan></text><line x1="533.0546875" x2="773.1796875" y1="852" y2="852" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="679.609375" y="872" width="187.140625" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="685.609375" y="892" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="684.609375">Add to jitter buffer</tspan></text></g><g class="note"><rect x="741.6875" y="921" width="62.984375" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="746.6875" y="941" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="746.6875">Decode</tspan></text></g><g class="note"><rect x="679.609375" y="970" width="187.140625" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="685.609375" y="990" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="684.609375">Apply volume ramping</tspan></text></g><g class="note"><rect x="658.21875" y="1019" width="229.921875" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="663.21875" y="1039" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="663.21875">Convert frames to samples</tspan></text></g><g class="note"><rect x="684.0078125" y="1068" width="178.34375" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="690.0078125" y="1088" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="689.0078125">Apply soft clipping</tspan></text></g><g class="note"><rect x="653.8203125" y="1117" width="238.71875" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="658.8203125" y="1137" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="658.8203125">Split mono to all channels</tspan></text></g><g class="note"><rect x="666.9140625" y="1166" width="212.53125" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="671.9140625" y="1186" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="671.9140625">Playback in AudioSource</tspan></text></g></svg>